<!DOCTYPE HTML>
<html>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="SheetMaker.js"></script>
<script>
var waitForFinalEvent = (function() {
    var timers = {};
    return function (callback, ms, uniqueId) {
        if (timers[uniqueId]) {
            clearTimeout(timers[uniqueId]);
        }
        timers[uniqueId] = setTimeout(callback, ms);
    };
})();

function getDataAndPlot() {
    d3.selectAll("#sheet svg").remove();

    var notes = $('#note-input').val();
    var noteResult = notes.split(/,| /).filter(function(n){ return n != ''; });
    var times = $('#time-input').val();
    var timeResult = times.split(/,| /).filter(function(n){ return n != ''; });
    console.log(noteResult, timeResult);

    //Convoluted way of finding the width of the div, because .width doesn't work. $("#sheet").width() is equivalent
    //below code may not work inside separate file
    var divWidth = parseInt(window.getComputedStyle(document.getElementById("sheet"), null).width);
    plotSheet(noteResult, timeResult, divWidth);
};

var allowResizePlotting = false;
$(document).ready(function() {
    $('#button').on('click', function() {
        getDataAndPlot();
        allowResizePlotting = true;
    });
    $(window).resize(function() {
        waitForFinalEvent(getDataAndPlot(), 200, "");
    });
});
</script>
Notes: <input id="note-input" type="text" name="NoteInput" /><br/>
Times: <input id="time-input" type="text" name="TimeInput" /><br/>
<input id="button" type="button" value="Generate Sheet" />

<div id="sheet">
</div>

</body>
</html>
